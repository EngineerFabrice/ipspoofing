<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ðŸŽ­ IP Spoofing Attack & Defense Lab</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='mobile.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ­</text></svg>">
    
    <style>
        /* Loading animation */
        @keyframes glitch {
            0% { transform: translate(0); opacity: 1; }
            20% { transform: translate(-2px, 2px); opacity: 0.8; }
            40% { transform: translate(-2px, -2px); opacity: 0.9; }
            60% { transform: translate(2px, 2px); opacity: 0.7; }
            80% { transform: translate(2px, -2px); opacity: 0.9; }
            100% { transform: translate(0); opacity: 1; }
        }
        
        .hacker-char {
            display: inline-block;
            animation: glitch 3s infinite;
        }
    </style>
</head>
<body class="{{ 'mobile' if device == 'mobile' else 'desktop' }}">
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="hacker-text" id="hacker-text">
                <!-- Text will be populated by JavaScript -->
            </div>
            <div class="loading-subtitle">Real-Time Attack & Defense Simulation</div>
            <div class="loading-progress">
                <div class="progress-bar"></div>
            </div>
            <div class="loading-tip">
                <i class="fas fa-lightbulb"></i>
                <span>Tip: Use PC as Hacker and Phone as Defender for optimal experience</span>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Header -->
        <header class="main-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-user-secret"></i>
                    <h1>IP Spoofing Lab</h1>
                </div>
                <div class="session-info">
                    <span class="session-id">Session: {{ session_id }}</span>
                    <span class="device-badge">
                        <i class="fas fa-{{ 'mobile-alt' if device == 'mobile' else 'desktop' }}"></i>
                        {{ device|title }}
                    </span>
                    <span class="role-badge {{ role }}">
                        <i class="fas fa-{{ 'mask' if role == 'hacker' else 'shield-alt' }}"></i>
                        {{ role|title }}
                    </span>
                </div>
            </div>
            
            <div class="header-center">
                <div class="connection-status">
                    <span class="status-dot" id="connection-dot"></span>
                    <span id="connection-status">Connecting...</span>
                    <span class="connections-count" id="connections-count">0 online</span>
                </div>
            </div>
            
            <div class="header-right">
                <div class="role-switcher">
                    <button id="switch-to-hacker" class="role-btn hacker-btn {{ 'active' if role == 'hacker' else '' }}">
                        <i class="fas fa-mask"></i>
                        <span>Hacker</span>
                    </button>
                    <button id="switch-to-defender" class="role-btn defender-btn {{ 'active' if role == 'defender' else '' }}">
                        <i class="fas fa-shield-alt"></i>
                        <span>Defender</span>
                    </button>
                </div>
                
                <button class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </header>

        <!-- Mobile Navigation Menu -->
        <nav class="mobile-nav" id="mobile-nav">
            <div class="nav-header">
                <h3>Navigation</h3>
                <button class="nav-close" id="nav-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="nav-items">
                <a href="#hacker-panel" class="nav-item" data-panel="hacker">
                    <i class="fas fa-mask"></i>
                    <span>Hacker Panel</span>
                </a>
                <a href="#defender-panel" class="nav-item" data-panel="defender">
                    <i class="fas fa-shield-alt"></i>
                    <span>Defender Panel</span>
                </a>
                <a href="#stats-panel" class="nav-item" data-panel="stats">
                    <i class="fas fa-chart-bar"></i>
                    <span>Statistics</span>
                </a>
                <a href="#education-panel" class="nav-item" data-panel="education">
                    <i class="fas fa-graduation-cap"></i>
                    <span>Education</span>
                </a>
                <a href="#logs-panel" class="nav-item" data-panel="logs">
                    <i class="fas fa-clipboard-list"></i>
                    <span>Attack Logs</span>
                </a>
            </div>
            <div class="nav-footer">
                <div class="ip-display-mobile">
                    <i class="fas fa-network-wired"></i>
                    <span>Your IP: <span id="mobile-ip-display">Loading...</span></span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Hacker Interface -->
            <section id="hacker-panel" class="panel hacker-panel {{ 'active' if role == 'hacker' else '' }}">
                <div class="panel-header hacker-header">
                    <h2><i class="fas fa-user-secret"></i> HACKER CONTROL PANEL</h2>
                    <div class="panel-subtitle">
                        <span class="status-badge active">
                            <i class="fas fa-circle"></i> SPOOFING MODE ACTIVE
                        </span>
                        <span class="session-info-small">
                            Session: {{ session_id }}
                        </span>
                    </div>
                </div>

                <div class="panel-content">
                    <!-- Real IP Display -->
                    <div class="card real-ip-card">
                        <div class="card-header">
                            <h3><i class="fas fa-fingerprint"></i> YOUR IDENTITY</h3>
                        </div>
                        <div class="card-body">
                            <div class="real-ip-container">
                                <div class="real-ip-label">
                                    <i class="fas fa-network-wired"></i> Your Real IP Address:
                                </div>
                                <div class="real-ip-value" id="real-ip-display">
                                    <i class="fas fa-spinner fa-spin"></i> Detecting...
                                </div>
                                <div class="ip-note">
                                    This is your actual IP address on the network
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- IP Spoofing Configuration -->
                    <div class="card spoofing-card">
                        <div class="card-header">
                            <h3><i class="fas fa-crosshairs"></i> IP SPOOFING CONFIGURATION</h3>
                            <button class="info-btn" data-info="spoofing">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </div>
                        
                        <div class="card-body">
                            <div class="mode-selection">
                                <div class="mode-option">
                                    <input type="radio" id="mode-legit" name="ip-mode" value="legit" checked>
                                    <label for="mode-legit" class="mode-label legit-mode">
                                        <div class="mode-icon">
                                            <i class="fas fa-user-check"></i>
                                        </div>
                                        <div class="mode-content">
                                            <div class="mode-title">Use Real IP</div>
                                            <div class="mode-desc">Send message with your actual IP address</div>
                                        </div>
                                    </label>
                                </div>
                                
                                <div class="mode-option">
                                    <input type="radio" id="mode-spoof" name="ip-mode" value="spoof">
                                    <label for="mode-spoof" class="mode-label spoof-mode">
                                        <div class="mode-icon">
                                            <i class="fas fa-user-secret"></i>
                                        </div>
                                        <div class="mode-content">
                                            <div class="mode-title">Spoof IP Address</div>
                                            <div class="mode-desc">Send message with fake IP address</div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Spoof Configuration Section -->
                            <div class="spoof-configuration" id="spoof-config">
                                <div class="config-section">
                                    <label for="spoofed-ip-input" class="config-label">
                                        <i class="fas fa-address-card"></i> Spoofed IP Address:
                                    </label>
                                    <div class="input-group">
                                        <input type="text" 
                                               id="spoofed-ip-input" 
                                               placeholder="e.g., 192.168.1.100"
                                               value="192.168.1.100"
                                               class="ip-input">
                                        <button id="generate-random-ip" class="action-btn" title="Generate Random IP">
                                            <i class="fas fa-random"></i>
                                        </button>
                                        <button id="validate-ip" class="action-btn" title="Validate IP">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    </div>
                                    <div class="ip-validation" id="ip-validation"></div>
                                </div>
                                
                                <!-- Quick IP Presets -->
                                <div class="quick-ips-section">
                                    <div class="section-title">
                                        <i class="fas fa-bolt"></i> Quick IP Presets
                                    </div>
                                    <div class="quick-ips-grid">
                                        <button class="quick-ip-btn" data-ip="192.168.1.100">
                                            <span class="ip">192.168.1.100</span>
                                            <span class="desc">Common Device</span>
                                        </button>
                                        <button class="quick-ip-btn" data-ip="10.0.0.50">
                                            <span class="ip">10.0.0.50</span>
                                            <span class="desc">Server</span>
                                        </button>
                                        <button class="quick-ip-btn" data-ip="8.8.8.8">
                                            <span class="ip">8.8.8.8</span>
                                            <span class="desc">Google DNS</span>
                                        </button>
                                        <button class="quick-ip-btn" data-ip="172.16.0.25">
                                            <span class="ip">172.16.0.25</span>
                                            <span class="desc">Subnet</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Message Preview -->
                            <div class="message-preview-section">
                                <div class="preview-header">
                                    <i class="fas fa-eye"></i> Message Preview
                                </div>
                                <div class="preview-content">
                                    <div class="preview-ip">
                                        <span class="label">From IP:</span>
                                        <span id="preview-ip" class="ip-value">Your real IP</span>
                                    </div>
                                    <div class="preview-message">
                                        <span class="label">Message:</span>
                                        <span id="preview-message" class="message-value">[Type your message below]</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Message Composition -->
                    <div class="card message-card">
                        <div class="card-header">
                            <h3><i class="fas fa-keyboard"></i> COMPOSE MESSAGE</h3>
                            <div class="message-templates">
                                 <a href="chat.html" class="chat-button">Go to Live Chat</a>

                                <button class="template-btn" data-template="normal">
                                    <i class="fas fa-comment"></i> Normal
                                </button>
                                <button class="template-btn" data-template="phishing">
                                    <i class="fas fa-fish"></i> Phishing
                                </button>
                                <button class="template-btn" data-template="attack">
                                    <i class="fas fa-bomb"></i> Attack
                                </button>
                            </div>
                        </div>
                        
                        <div class="card-body">
                            <div class="message-input-container">
                                <textarea id="hacker-message" 
                                          placeholder="Type your message here...
Example phishing: 'URGENT: Your account has been compromised. Click here to reset password now!'
Example DDoS: 'Initiating SYN flood attack from multiple spoofed sources...'
Example normal: 'Hello, this is a regular message from the network admin'"
                                          rows="5"
                                          maxlength="500"></textarea>
                                <div class="message-controls">
                                    <div class="char-count">
                                        <span id="char-count">0</span>/500 characters
                                    </div>
                                    <button id="clear-message" class="small-btn">
                                        <i class="fas fa-trash"></i> Clear
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                   
                    <!-- Attack Controls -->
                    <div class="card attack-card">
                        <div class="card-header">
                            <h3><i class="fas fa-rocket"></i> ATTACK CONTROLS</h3>
                        </div>
                        
                        <div class="card-body">
                            <div class="primary-action">
                                <button id="send-message-btn" class="btn-primary hacker-send">
                                    <i class="fas fa-paper-plane"></i>
                                    <span>SEND MESSAGE</span>
                                </button>
                            </div>
                            
                            <div class="simulation-section">
                                <div class="section-title">
                                    <i class="fas fa-gamepad"></i> Quick Simulations
                                </div>
                                <div class="simulation-buttons">
                                    <button class="simulate-btn" data-type="ddos">
                                        <i class="fas fa-cloud-rain"></i>
                                        <span>DDoS Attack</span>
                                    </button>
                                    <button class="simulate-btn" data-type="phishing">
                                        <i class="fas fa-fish"></i>
                                        <span>Phishing</span>
                                    </button>
                                    <button class="simulate-btn" data-type="mitm">
                                        <i class="fas fa-exchange-alt"></i>
                                        <span>MITM</span>
                                    </button>
                                    <button class="simulate-btn" data-type="scanning">
                                        <i class="fas fa-search"></i>
                                        <span>Scanning</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Hacker Statistics -->
                    <div class="card hacker-stats-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-line"></i> ATTACK STATISTICS</h3>
                            <button id="refresh-hacker-stats" class="refresh-btn">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        
                        <div class="card-body">
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fas fa-paper-plane"></i>
                                    </div>
                                    <div class="stat-data">
                                        <div class="stat-value" id="total-sent">0</div>
                                        <div class="stat-label">Messages Sent</div>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fas fa-user-secret"></i>
                                    </div>
                                    <div class="stat-data">
                                        <div class="stat-value" id="spoofed-sent">0</div>
                                        <div class="stat-label">Spoofed</div>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fas fa-eye"></i>
                                    </div>
                                    <div class="stat-data">
                                        <div class="stat-value" id="detected-count">0</div>
                                        <div class="stat-label">Detected</div>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fas fa-percentage"></i>
                                    </div>
                                    <div class="stat-data">
                                        <div class="stat-value" id="success-rate">0%</div>
                                        <div class="stat-label">Success Rate</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Defender Interface -->
            <section id="defender-panel" class="panel defender-panel {{ 'active' if role == 'defender' else '' }}">
                <div class="panel-header defender-header">
                    <h2><i class="fas fa-shield-alt"></i> DEFENDER ANALYSIS PANEL</h2>
                    <div class="panel-subtitle">
                        <span class="status-badge monitoring">
                            <i class="fas fa-eye"></i> MONITORING NETWORK TRAFFIC
                        </span>
                        <span class="alerts-count" id="alerts-count">
                            <i class="fas fa-bell"></i> <span id="alert-number">0</span> Alerts
                        </span>
                    </div>
                </div>

                <div class="panel-content">
                    <!-- Live Traffic Monitor -->
                    <div class="card traffic-card">
                        <div class="card-header">
                            <h3><i class="fas fa-satellite-dish"></i> LIVE TRAFFIC MONITOR</h3>
                            <div class="traffic-controls">
                                <select id="traffic-filter" class="filter-select">
                                    <option value="all">All Messages</option>
                                    <option value="spoofed">Suspicious Only</option>
                                    <option value="legitimate">Legitimate Only</option>
                                    <option value="unanalyzed">Unanalyzed</option>
                                </select>
                                <button id="refresh-traffic" class="small-btn">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="card-body">
                            <div class="traffic-stats">
                                <div class="traffic-stat">
                                    <span class="stat-label">Total Messages:</span>
                                    <span class="stat-value" id="total-messages-count">0</span>
                                </div>
                                <div class="traffic-stat">
                                    <span class="stat-label">Suspicious:</span>
                                    <span class="stat-value suspicious" id="suspicious-count">0</span>
                                </div>
                                <div class="traffic-stat">
                                    <span class="stat-label">Analyzed:</span>
                                    <span class="stat-value" id="analyzed-count">0</span>
                                </div>
                            </div>
                            
                            <div class="messages-container">
                                <div class="messages-header">
                                    <span class="header-item">From IP</span>
                                    <span class="header-item">Time</span>
                                    <span class="header-item">Status</span>
                                </div>
                                <div class="messages-list" id="messages-list">
                                    <div class="empty-state">
                                        <i class="fas fa-envelope-open-text"></i>
                                        <h4>No messages yet</h4>
                                        <p>Messages will appear here when hackers send them</p>
                                        <p class="hint">Each message shows the sender's IP address</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Message Analysis Tool -->
                    <div class="card analysis-card" id="analysis-card" style="display: none;">
                        <div class="card-header">
                            <h3><i class="fas fa-search"></i> MESSAGE ANALYSIS</h3>
                            <button class="close-analysis" id="close-analysis">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="card-body">
                            <div class="selected-message" id="selected-message-details">
                                <!-- Message details will be inserted here -->
                            </div>
                            
                            <div class="analysis-interface">
                                <h4 class="analysis-title">
                                    <i class="fas fa-question-circle"></i> Is this IP address spoofed?
                                </h4>
                                
                                <div class="guess-selection">
                                    <button class="guess-btn legit-guess" data-guess="legitimate">
                                        <div class="guess-icon">
                                            <i class="fas fa-user-check"></i>
                                        </div>
                                        <div class="guess-content">
                                            <div class="guess-title">Legitimate IP</div>
                                            <div class="guess-desc">IP address appears to be real</div>
                                        </div>
                                    </button>
                                    
                                    <button class="guess-btn spoof-guess" data-guess="spoofed">
                                        <div class="guess-icon">
                                            <i class="fas fa-user-secret"></i>
                                        </div>
                                        <div class="guess-content">
                                            <div class="guess-title">Spoofed IP</div>
                                            <div class="guess-desc">IP address appears to be fake</div>
                                        </div>
                                    </button>
                                </div>
                                
                                <div class="confidence-control">
                                    <div class="confidence-header">
                                        <i class="fas fa-brain"></i>
                                        <span>Analysis Confidence:</span>
                                        <span id="confidence-value">50</span>%
                                    </div>
                                    <div class="slider-container">
                                        <input type="range" id="confidence-slider" min="0" max="100" value="50">
                                        <div class="slider-labels">
                                            <span>Unsure</span>
                                            <span>Confident</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="analysis-actions">
                                    <button id="submit-analysis" class="btn-primary defender-analyze">
                                        <i class="fas fa-check-circle"></i>
                                        <span>ANALYZE MESSAGE</span>
                                    </button>
                                    <button id="skip-analysis" class="btn-secondary">
                                        <i class="fas fa-forward"></i>
                                        <span>Skip</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Results -->
                    <div class="card result-card" id="result-card" style="display: none;">
                        <div class="card-header">
                            <h3><i class="fas fa-clipboard-check"></i> ANALYSIS RESULT</h3>
                            <button class="close-result" id="close-result">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="card-body">
                            <div class="result-content" id="result-content">
                                <!-- Results will be inserted here -->
                            </div>
                        </div>
                    </div>

                    <!-- Defender Tools -->
                    <div class="card tools-card">
                        <div class="card-header">
                            <h3><i class="fas fa-tools"></i> DEFENSE TOOLKIT</h3>
                        </div>
                        
                        <div class="card-body">
                            <div class="tools-grid">
                                <div class="tool-item" data-tool="filtering">
                                    <div class="tool-icon">
                                        <i class="fas fa-filter"></i>
                                    </div>
                                    <h4>Ingress Filtering</h4>
                                    <p>Block packets with impossible source IPs</p>
                                </div>
                                <div class="tool-item" data-tool="authentication">
                                    <div class="tool-icon">
                                        <i class="fas fa-fingerprint"></i>
                                    </div>
                                    <h4>IP Authentication</h4>
                                    <p>Cryptographic verification of source</p>
                                </div>
                                <div class="tool-item" data-tool="analysis">
                                    <div class="tool-icon">
                                        <i class="fas fa-chart-network"></i>
                                    </div>
                                    <h4>Traffic Analysis</h4>
                                    <p>Monitor for unusual patterns</p>
                                </div>
                                <div class="tool-item" data-tool="alerts">
                                    <div class="tool-icon">
                                        <i class="fas fa-bell"></i>
                                    </div>
                                    <h4>Alert System</h4>
                                    <p>Notify of suspicious activity</p>
                                </div>
                            </div>
                            
                            <div class="defense-tips">
                                <h4><i class="fas fa-lightbulb"></i> Quick Defense Tips</h4>
                                <ul>
                                    <li>Check for private IPs in external traffic</li>
                                    <li>Monitor for unusual traffic patterns</li>
                                    <li>Implement egress filtering</li>
                                    <li>Use encrypted protocols (HTTPS, IPsec)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Defender Statistics -->
                    <div class="card defender-stats-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-bar"></i> DEFENSE PERFORMANCE</h3>
                            <button id="refresh-defender-stats" class="refresh-btn">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        
                        <div class="card-body">
                            <div class="performance-metrics">
                                <div class="metric">
                                    <div class="metric-value" id="total-analyzed">0</div>
                                    <div class="metric-label">Messages Analyzed</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value correct" id="correct-detections">0</div>
                                    <div class="metric-label">Correct</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value incorrect" id="incorrect-detections">0</div>
                                    <div class="metric-label">Incorrect</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value" id="detection-accuracy">90%</div>
                                    <div class="metric-label">Accuracy</div>
                                </div>
                            </div>
                            
                            <div class="performance-chart">
                                <canvas id="defender-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Statistics Panel -->
            <section id="stats-panel" class="panel stats-panel">
                <div class="panel-header stats-header">
                    <h2><i class="fas fa-chart-pie"></i> SYSTEM STATISTICS</h2>
                    <button id="export-data" class="btn-secondary">
                        <i class="fas fa-download"></i> Export Data
                    </button>
                </div>

                <div class="panel-content">
                    <div class="stats-overview">
                        <div class="stat-card-large">
                            <div class="stat-icon">
                                <i class="fas fa-broadcast-tower"></i>
                            </div>
                            <div class="stat-data">
                                <div class="stat-number" id="total-messages-stat">0</div>
                                <div class="stat-label">Total Messages</div>
                                <div class="stat-breakdown">
                                    <span class="breakdown-item legit">
                                        <i class="fas fa-user-check"></i>
                                        <span id="legit-messages-stat">0</span> Legitimate
                                    </span>
                                    <span class="breakdown-item spoof">
                                        <i class="fas fa-user-secret"></i>
                                        <span id="spoofed-messages-stat">0</span> Spoofed
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <canvas id="attack-chart"></canvas>
                        </div>
                    </div>

                    <div class="detailed-stats">
                        <div class="detailed-stat">
                            <h4><i class="fas fa-network-wired"></i> Network Activity</h4>
                            <div class="stat-details">
                                <div class="detail-item">
                                    <span>Active Connections:</span>
                                    <span id="active-connections">0</span>
                                </div>
                                <div class="detail-item">
                                    <span>Spoofing Rate:</span>
                                    <span id="spoofing-rate-stat">0%</span>
                                </div>
                                <div class="detail-item">
                                    <span>Detection Rate:</span>
                                    <span id="detection-rate">0%</span>
                                </div>
                                <div class="detail-item">
                                    <span>Response Time:</span>
                                    <span id="response-time">0ms</span>
                                </div>
                            </div>
                        </div>

                        <div class="detailed-stat">
                            <h4><i class="fas fa-user-shield"></i> Top Spoofed IPs</h4>
                            <div class="top-ips" id="top-spoofed-ips">
                                <div class="top-ip-item">
                                    <span class="ip-rank">1</span>
                                    <span class="ip-address">-</span>
                                    <span class="ip-count">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="detailed-stat">
                            <h4><i class="fas fa-history"></i> Recent Activity</h4>
                            <div class="activity-timeline" id="activity-timeline">
                                <div class="activity-item">
                                    <span class="activity-time">-</span>
                                    <span class="activity-desc">No recent activity</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Education Panel -->
            <section id="education-panel" class="panel education-panel">
                <div class="panel-header education-header">
                    <h2><i class="fas fa-graduation-cap"></i> EDUCATIONAL RESOURCES</h2>
                </div>

                <div class="panel-content">
                    <div class="education-content">
                        <div class="education-section">
                            <h3><i class="fas fa-exclamation-triangle"></i> What is IP Spoofing?</h3>
                            <div class="definition-box">
                                <p>IP spoofing is the creation of Internet Protocol (IP) packets with a false source IP address, for the purpose of impersonating another computing system.</p>
                            </div>
                            
                            <div class="key-points">
                                <div class="point">
                                    <i class="fas fa-bullseye"></i>
                                    <div class="point-content">
                                        <strong>Purpose:</strong>
                                        <p>Hide identity, impersonate legitimate systems, bypass security controls, or launch denial-of-service attacks.</p>
                                    </div>
                                </div>
                                <div class="point">
                                    <i class="fas fa-shield-alt"></i>
                                    <div class="point-content">
                                        <strong>Impact:</strong>
                                        <p>DDoS attacks, man-in-the-middle attacks, session hijacking, credential theft, and network reconnaissance.</p>
                                    </div>
                                </div>
                                <div class="point">
                                    <i class="fas fa-wrench"></i>
                                    <div class="point-content">
                                        <strong>Prevention:</strong>
                                        <p>Ingress/egress filtering, encryption (SSL/TLS, IPsec), authentication mechanisms, and traffic monitoring.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="education-section">
                            <h3><i class="fas fa-search"></i> Detection Methods</h3>
                            <div class="detection-methods">
                                <div class="method">
                                    <div class="method-icon">
                                        <i class="fas fa-filter"></i>
                                    </div>
                                    <h4>Ingress Filtering</h4>
                                    <p>Check if source IP is valid for the network interface receiving the packet.</p>
                                </div>
                                <div class="method">
                                    <div class="method-icon">
                                        <i class="fas fa-list-ol"></i>
                                    </div>
                                    <h4>TCP Sequence Analysis</h4>
                                    <p>Monitor TCP sequence numbers for predictability or inconsistencies.</p>
                                </div>
                                <div class="method">
                                    <div class="method-icon">
                                        <i class="fas fa-route"></i>
                                    </div>
                                    <h4>Hop Count Analysis</h4>
                                    <p>Check TTL values for inconsistencies with expected hop counts.</p>
                                </div>
                                <div class="method">
                                    <div class="method-icon">
                                        <i class="fas fa-map-marker-alt"></i>
                                    </div>
                                    <h4>Geolocation Verification</h4>
                                    <p>Verify if source IP matches expected geographic location.</p>
                                </div>
                            </div>
                        </div>

                        <div class="education-section">
                            <h3><i class="fas fa-desktop"></i> Lab Instructions</h3>
                            <div class="instructions">
                                <div class="instruction-step">
                                    <span class="step-number">1</span>
                                    <div class="step-content">
                                        <h4>Set Up Devices</h4>
                                        <p>Use <strong>PC/Laptop as Hacker</strong> to send spoofed messages</p>
                                        <p>Use <strong>Phone/Tablet as Defender</strong> to analyze traffic</p>
                                    </div>
                                </div>
                                <div class="instruction-step">
                                    <span class="step-number">2</span>
                                    <div class="step-content">
                                        <h4>Connect to Same Network</h4>
                                        <p>Ensure both devices are connected to the same WiFi network</p>
                                        <p>Access the lab using the provided URLs</p>
                                    </div>
                                </div>
                                <div class="instruction-step">
                                    <span class="step-number">3</span>
                                    <div class="step-content">
                                        <h4>Start Experimenting</h4>
                                        <p>Send messages from Hacker interface (with real or spoofed IPs)</p>
                                        <p>Analyze and detect spoofed messages in Defender interface</p>
                                    </div>
                                </div>
                                <div class="instruction-step">
                                    <span class="step-number">4</span>
                                    <div class="step-content">
                                        <h4>Review Results</h4>
                                        <p>Check statistics to see detection accuracy</p>
                                        <p>Learn from educational hints and defense tips</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Attack Logs Panel -->
            <section id="logs-panel" class="panel logs-panel">
                <div class="panel-header logs-header">
                    <h2><i class="fas fa-clipboard-list"></i> ATTACK LOGS</h2>
                    <button id="clear-logs" class="btn-secondary">
                        <i class="fas fa-trash"></i> Clear Logs
                    </button>
                </div>

                <div class="panel-content">
                    <div class="logs-container">
                        <div class="logs-header">
                            <span class="log-timestamp">Timestamp</span>
                            <span class="log-type">Type</span>
                            <span class="log-ip">Real IP</span>
                            <span class="log-spoofed">Spoofed IP</span>
                            <span class="log-message">Message</span>
                        </div>
                        <div class="logs-list" id="logs-list">
                            <div class="empty-state">
                                <i class="fas fa-clipboard"></i>
                                <h4>No attack logs yet</h4>
                                <p>Attack logs will appear here when spoofed messages are sent</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="log-stats">
                        <div class="log-stat">
                            <div class="stat-value" id="total-logs">0</div>
                            <div class="stat-label">Total Logs</div>
                        </div>
                        <div class="log-stat">
                            <div class="stat-value" id="ddos-logs">0</div>
                            <div class="stat-label">DDoS Attacks</div>
                        </div>
                        <div class="log-stat">
                            <div class="stat-value" id="phishing-logs">0</div>
                            <div class="stat-label">Phishing</div>
                        </div>
                        <div class="log-stat">
                            <div class="stat-value" id="mitm-logs">0</div>
                            <div class="stat-label">MITM</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-content">
                <div class="footer-left">
                    <div class="educational-notice">
                        <i class="fas fa-graduation-cap"></i>
                        <span>ACADEMIC DEMONSTRATION ONLY - For Educational Purposes</span>
                    </div>
                </div>
                
                <div class="footer-center">
                    <div class="server-status">
                        <span class="server-time" id="server-time">--:--:--</span>
                        <span class="server-uptime" id="server-uptime">Uptime: 0s</span>
                    </div>
                </div>
                
                <div class="footer-right">
                    <div class="system-controls">
                        <button id="clear-all-btn" class="footer-btn">
                            <i class="fas fa-trash"></i> Clear All
                        </button>
                        <button id="refresh-all-btn" class="footer-btn">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                        <button id="help-btn" class="footer-btn">
                            <i class="fas fa-question-circle"></i> Help
                        </button>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Help Modal -->
    <div class="modal" id="help-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-question-circle"></i> IP Spoofing Lab - Help Guide</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="help-section">
                    <h4><i class="fas fa-info-circle"></i> How to Use This Lab</h4>
                    <p>This is an educational tool to demonstrate IP spoofing attacks and defense techniques.</p>
                    
                    <h5>Setup Instructions:</h5>
                    <ol>
                        <li><strong>Start the server</strong> on your PC/Laptop</li>
                        <li><strong>Connect your phone</strong> to the same WiFi network</li>
                        <li><strong>Access the lab</strong> using the provided URLs</li>
                        <li><strong>PC auto-assigns as Hacker</strong>, Phone as Defender</li>
                    </ol>
                    
                    <h5>Hacker Interface (PC):</h5>
                    <ul>
                        <li>Compose messages with real or spoofed IP addresses</li>
                        <li>Use quick IP presets or enter custom IPs</li>
                        <li>Simulate different types of attacks</li>
                        <li>Monitor your attack statistics</li>
                    </ul>
                    
                    <h5>Defender Interface (Phone):</h5>
                    <ul>
                        <li>Monitor incoming network traffic in real-time</li>
                        <li>Analyze messages to detect spoofed IPs</li>
                        <li>Learn defense techniques and tips</li>
                        <li>Track your detection accuracy</li>
                    </ul>
                    
                    <h5>Troubleshooting:</h5>
                    <ul>
                        <li><strong>Can't connect?</strong> Ensure both devices on same network  or call designer by email : fabricendayisaba16@gmail.com  from Rwanda </li>
                        <li><strong>Messages not appearing?</strong> Check connection status</li>
                        <li><strong>IP spoofing not working?</strong> Verify you selected spoofing mode</li>
                        <li><strong>Need to reset?</strong> Use "Clear All" button</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    
    <script>
        // Initialize with server data
        const initialData = {
            role: "{{ role }}",
            device: "{{ device }}",
            sessionId: "{{ session_id }}",
            realIp: "{{ real_ip }}"
        };
        
        // Set up toastr
        toastr.options = {
            positionClass: initialData.device === 'mobile' ? 'toast-bottom-full-width' : 'toast-top-right',
            timeOut: 4000,
            closeButton: true,
            progressBar: true,
            preventDuplicates: true
        };
        
        // Create loading animation
        document.addEventListener('DOMContentLoaded', function() {
            const hackerText = document.getElementById('hacker-text');
            const text = "IP SPOOFING LAB";
            
            text.split('').forEach((char, index) => {
                const span = document.createElement('span');
                span.className = 'hacker-char';
                span.textContent = char === ' ' ? '\u00A0' : char;
                span.style.animationDelay = `${index * 0.1}s`;
                hackerText.appendChild(span);
            });
            
            // Hide loading screen after 2 seconds
            setTimeout(() => {
                document.getElementById('loading-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loading-screen').style.display = 'none';
                }, 500);
            }, 2000);
        });
    </script>
</body>
</html>